应用：

    根據需要選擇不同的模型來進行訓練和異常檢測。   

模型簡介：
全連接自編碼器（FCN）：

這是一種最基本的自編碼器模型，使用全連接層（線性層）來進行特徵編碼和解碼。
適用於低維度數據。
卷積自編碼器（CNN）：

這種自編碼器模型使用卷積層和卷積轉置層進行特徵編碼和解碼。
對於圖像數據更為適用，因為卷積層可以有效地提取圖像的空間特徵。
變分自編碼器（VAE）：

這是一種生成模型，它在自編碼器的基礎上引入了概率推斷，用於學習數據的分佈。
包含編碼器、重新參數化層（用於從高斯分佈中取樣）和解碼器。
ResNet模型：

ResNet（Residual Network）是一種深度殘差神經網絡，這裡用作特徵提取器。
在這個代碼中，ResNet被用作編碼器的一部分，從圖像中提取高級特徵，然後通過全連接層進行進一步處理和解碼。


運作流程：

數據準備：

        將數據集載入並進行預處理。這裡使用的公開數據集是MNIST數據集，它是一個經典的手寫數字數據集，適合用於異常檢測的範例。
        

模型定義與選擇：

        定義不同的自編碼器（FCN、CNN、VAE）和ResNet模型。

訓練模型：

        將選定的模型載入到GPU（如果可用但我这边只用cpu）。

        訓練過程中，使用選定的模型進行前向傳播、計算損失、反向傳播和參數更新。

        進度條qqdm顯示訓練過程中的進度和損失。

定义损失函数和优化器：

        定义 不同自编码器的训练损失函数。

保存最佳模型：

        在每個epoch結束後，計算平均損失，並保存最佳模型和最後一次訓練的模型。
        
        為了在下次使用時能夠加載這些模型，我們可以保存模型結構和狀態字典。在 PyTorch 中，我們通常會保存模型的狀態字典，而不是整個模型對象，這樣可以更靈活地重新加載模型。

測試模型：

        使用測試數據進行異常檢測。
        
        計算每個樣本的重建誤差。

        可视化结果。

可视化结果：

ROC 曲线位置：

        ROC 曲线越靠近左上角（TPR 高且 FPR 低），分类器性能越好。
        ROC 曲线越接近对角线（随机猜测的表现），分类器性能越差。
        
AUC 值：

        AUC 值越接近 1，表示分类器的整体性能越好。
        AUC 值为 0.5 表示分类器的性能与随机猜测一样差。

虚线:

        这条虚线对应于一个随机猜测的分类器，即对于每个输入，它以 50% 的概率随机地预测为正类或负类。在这条线上的每个点表示对于某个阈值，分类器的真阳性率（TPR）和假阳性率（FPR）相等，表现如同随机猜测。如果 ROC 曲线在虚线之上，说明分类器的性能优于随机猜测。如果 ROC 曲线接近虚线甚至在虚线之下，说明分类器的性能与随机猜测差不多甚至更差。

![image](https://github.com/joycelai140420/Project/assets/167413809/d6016cb9-1a77-469a-8426-64f9a8b2ee43)

![image](https://github.com/joycelai140420/Project/assets/167413809/a824e1e9-2977-4c96-8922-96dbebd1a8fc)

![image](https://github.com/joycelai140420/Project/assets/167413809/499dcc8f-d960-4474-8627-729cf51da927)

![image](https://github.com/joycelai140420/Project/assets/167413809/6c931d08-666f-40f9-a8bc-20ff63bdad8c)


tips:
    因為使用多個模型，會有很多數據不匹配格式不符合張量不適配等等問題，所以建議在cpu調試再轉gpu
