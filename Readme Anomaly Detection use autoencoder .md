应用：

    根據需要選擇不同的模型來進行訓練和異常檢測。   

模型簡介：
全連接自編碼器（FCN）：

這是一種最基本的自編碼器模型，使用全連接層（線性層）來進行特徵編碼和解碼。
適用於低維度數據。
卷積自編碼器（CNN）：

這種自編碼器模型使用卷積層和卷積轉置層進行特徵編碼和解碼。
對於圖像數據更為適用，因為卷積層可以有效地提取圖像的空間特徵。
變分自編碼器（VAE）：

這是一種生成模型，它在自編碼器的基礎上引入了概率推斷，用於學習數據的分佈。
包含編碼器、重新參數化層（用於從高斯分佈中取樣）和解碼器。
ResNet模型：

ResNet（Residual Network）是一種深度殘差神經網絡，這裡用作特徵提取器。
在這個代碼中，ResNet被用作編碼器的一部分，從圖像中提取高級特徵，然後通過全連接層進行進一步處理和解碼。


運作流程：

數據準備：

        將數據集載入並進行預處理。這裡使用的公開數據集是MNIST數據集，它是一個經典的手寫數字數據集，適合用於異常檢測的範例。
        
        使用自定義的 CustomTensorDataset 類來創建數據加載器。

模型定義與選擇：

        定義不同的自編碼器和ResNet模型。
        
        根據 model_type 參數選擇需要使用的模型。代碼中定義了四種模型，但在訓練和測試過程中，只選擇其中一個模型進行操作。具體選擇哪個模型是通過 model_type 參數來決定的。

訓練模型：

        將選定的模型載入到GPU（如果可用但我这边只用cpu）。

        訓練過程中，使用選定的模型進行前向傳播、計算損失、反向傳播和參數更新。

        進度條qqdm顯示訓練過程中的進度和損失。

保存最佳模型：

        在每個epoch結束後，計算平均損失，並保存最佳模型和最後一次訓練的模型。
        
        為了在下次使用時能夠加載這些模型，我們可以保存模型結構和狀態字典。在 PyTorch 中，我們通常會保存模型的狀態字典，而不是整個模型對象，這樣可以更靈活地重新加載模型。

測試模型：

        使用測試數據進行異常檢測。
        
        計算每個樣本的重建誤差，並將結果保存到CSV文件中。

        可视化结果。

tips:
    因為使用多個模型，會有很多數據不匹配格式不符合張量不適配等等問題，所以建議在cpu調試再轉gpu
